<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ê°ê°€ ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: 0 auto;
      padding: 20px;
    }
    .car-container {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: auto;
    }
    .car-image {
      width: 100%;
      height: auto;
      display: block;
    }
    .checkbox {
      position: absolute;
      transform: translate(-50%, -50%);
    }
    #deductionArea {
      background: #f9f9f9;
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    h2 {
      font-size: 18px;
      margin-bottom: 8px;
    }
    .deduction-total {
      margin-top: 10px;
      font-weight: bold;
      color: #d00;
    }
    .final-price {
      font-size: 20px;
      margin-top: 20px;
      font-weight: bold;
      color: #007700;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš— ê°ê°€ ê³„ì‚°ê¸°</h1>

    <div class="car-container">
      <img src="https://via.placeholder.com/600x300?text=Car+Image" class="car-image" alt="ìë™ì°¨" />
      <!-- ì²´í¬ë°•ìŠ¤ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
    </div>

    <div style="margin-top: 20px;">
      <label><input type="checkbox" id="isAccident" onchange="updateAll()"> ì‚¬ê³ ì°¨ëŸ‰ ì—¬ë¶€</label><br/>
      <label><input type="checkbox" id="needsRepair" onchange="updateAll()"> ìˆ˜ë¦¬ìš”ë§</label>
      <input type="number" id="repairCost" placeholder="ìˆ˜ë¦¬ë¹„ ì…ë ¥ (ì›)" oninput="updateAll()" style="width: 150px;">
    </div>

    <div id="deductionArea"></div>
    <div class="final-price">ìµœì¢… ì…ì°°ê°€: <span id="finalPrice"></span> ì›</div>
  </div>

  <script>
    const bidPrice = 140000; // ê¸°ë³¸ ì…ì°°ê°€

    const accidentParts = [
      { name: "í”„ë¡ íŠ¸ë²”í¼", rate: 3, top: '20%', left: '20%' },
      { name: "ë³´ë‹›", rate: 4, top: '20%', left: '40%' },
      { name: "ë£¨í”„", rate: 5, top: '10%', left: '50%' },
      { name: "íŠ¸ë í¬", rate: 3, top: '30%', left: '80%' },
      { name: "ë¦¬ì–´ë²”í¼", rate: 3, top: '35%', left: '90%' },
      { name: "ì¢Œì¸¡ì•ë„ì–´", rate: 2, top: '30%', left: '25%' },
      { name: "ì¢Œì¸¡ë’·ë„ì–´", rate: 2, top: '30%', left: '35%' },
      { name: "ìš°ì¸¡ì•ë„ì–´", rate: 2, top: '30%', left: '65%' },
      { name: "ìš°ì¸¡ë’·ë„ì–´", rate: 2, top: '30%', left: '75%' },
      { name: "ì¢Œì¸¡íœ€ë”", rate: 2, top: '25%', left: '10%' },
      { name: "ìš°ì¸¡íœ€ë”", rate: 2, top: '25%', left: '90%' },
      { name: "ì¢Œì¸¡ì‚¬ì´ë“œìŠ¤ì»¤íŠ¸", rate: 1, top: '50%', left: '25%' },
      { name: "ìš°ì¸¡ì‚¬ì´ë“œìŠ¤ì»¤íŠ¸", rate: 1, top: '50%', left: '75%' },
      { name: "ì„œìŠ¤íœì…˜", rate: 3, top: '60%', left: '50%' },
      { name: "ì—”ì§„", rate: 5, top: '45%', left: '50%' },
      { name: "ë¯¸ì…˜", rate: 4, top: '55%', left: '50%' },
      { name: "í•˜ì²´ë¶€í’ˆ", rate: 3, top: '65%', left: '50%' },
      { name: "ë¼ë””ì—ì´í„°", rate: 2, top: '40%', left: '40%' },
      { name: "ë°°í„°ë¦¬", rate: 2, top: '40%', left: '60%' },
      { name: "ì•ìœ ë¦¬", rate: 1, top: '15%', left: '50%' },
      { name: "ë’¤ìœ ë¦¬", rate: 1, top: '25%', left: '50%' },
      { name: "ì „ì¡°ë“±", rate: 1, top: '20%', left: '30%' },
      { name: "í›„ë¯¸ë“±", rate: 1, top: '30%', left: '90%' },
      { name: "íƒ€ì´ì–´", rate: 1, top: '70%', left: '50%' },
      { name: "ë¨¸í”ŒëŸ¬", rate: 2, top: '80%', left: '50%' }
    ];

    const container = document.querySelector('.car-container');

    accidentParts.forEach((part, i) => {
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.className = 'checkbox';
      checkbox.style.top = part.top;
      checkbox.style.left = part.left;
      checkbox.id = `part${i}`;
      checkbox.setAttribute('data-name', part.name);
      checkbox.setAttribute('data-rate', part.rate);
      checkbox.onchange = updateAll;
      container.appendChild(checkbox);
    });

    function getNumericValue(value) {
      const num = parseInt(value.toString().replace(/[^0-9]/g, ''), 10);
      return isNaN(num) ? 0 : num;
    }

    function updateAll() {
      let partDiscount = 0;
      let accidentDiscount = 0;
      const deductionDetails = [];

      // ë¶€ìœ„ ì²´í¬
      document.querySelectorAll('.checkbox').forEach(cb => {
        if (cb.checked) {
          const name = cb.getAttribute('data-name');
          const rate = parseFloat(cb.getAttribute('data-rate'));
          const amount = Math.round(bidPrice * (rate / 100));
          partDiscount += amount;
          deductionDetails.push(`${name} (${rate}%) -${amount.toLocaleString()}ì›`);
        }
      });

      // ì‚¬ê³ ì°¨ ì—¬ë¶€
      if (document.getElementById('isAccident').checked) {
        accidentDiscount = Math.round(bidPrice * 0.2); // 20%
        deductionDetails.push(`ì‚¬ê³ ì´ë ¥: -${accidentDiscount.toLocaleString()}ì›`);
      }

      // ìˆ˜ë¦¬ìš”ë§
      if (document.getElementById('needsRepair').checked) {
        const repairCost = getNumericValue(document.getElementById('repairCost').value);
        if (repairCost > 0) {
          deductionDetails.push(`ìˆ˜ë¦¬ìš”ë§: -${repairCost.toLocaleString()}ì›`);
          partDiscount += repairCost;
        }
      }

      const totalDiscount = partDiscount + accidentDiscount;
      const finalPrice = Math.max(bidPrice - totalDiscount, 0);
      document.getElementById('finalPrice').innerText = finalPrice.toLocaleString();

      // ê°ê°€ë‚´ì—­ í‘œì‹œ
      const deductionHTML = `
        <h2>ğŸ“‹ ê°ê°€ ë‚´ì—­</h2>
        <ul>${deductionDetails.map(d => `<li>${d}</li>`).join('')}</ul>
        <div class="deduction-total">ì´ ê°ê°€ì•¡: -${totalDiscount.toLocaleString()}ì›</div>
      `;
      document.getElementById('deductionArea').innerHTML = deductionHTML;
    }

    // ì´ˆê¸° ê³„ì‚°
    updateAll();
  </script>
</body>
</html>
