<style>
.checkbox-item {
  position: absolute;
  transform: translate(-50%, -50%);
  background-color: transparent;
  padding: 5px 8px;
  border-radius: 8px;
  transition: background-color 0.3s ease;
  font-size: 12px;
  font-weight: bold;
}

/* 선택됐을 때 빨간색 배경 */
.checkbox-item.selected {
  background-color: rgba(255, 0, 0, 0.7);
  color: white;
}

/* 초기화 버튼 스타일 */
#resetButton {
  margin: 20px;
  padding: 10px 20px;
  font-size: 16px;
  background-color: #ff4d4d;
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
}
</style>

<!-- 체크박스 전체 영역 -->
<div class="checkbox-overlay" id="accidentSection" style="position: relative; width: 100%; height: 600px; background-color: #f0f0f0;">
  <!-- 30개 체크박스 배치 -->
  <label class="checkbox-item" style="top:5%; left:8%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">1</label>
  <label class="checkbox-item" style="top:10%; left:20%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">2</label>
  <label class="checkbox-item" style="top:8%; left:40%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">3</label>
  <label class="checkbox-item" style="top:7%; left:70%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">4</label>
  <label class="checkbox-item" style="top:12%; left:90%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">5</label>

  <label class="checkbox-item" style="top:20%; left:10%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">6</label>
  <label class="checkbox-item" style="top:18%; left:30%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">7</label>
  <label class="checkbox-item" style="top:22%; left:50%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">8</label>
  <label class="checkbox-item" style="top:25%; left:70%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">9</label>
  <label class="checkbox-item" style="top:21%; left:85%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">10</label>

  <label class="checkbox-item" style="top:30%; left:5%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">11</label>
  <label class="checkbox-item" style="top:33%; left:20%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">12</label>
  <label class="checkbox-item" style="top:28%; left:45%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">13</label>
  <label class="checkbox-item" style="top:31%; left:65%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">14</label>
  <label class="checkbox-item" style="top:29%; left:90%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">15</label>

  <label class="checkbox-item" style="top:40%; left:15%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">16</label>
  <label class="checkbox-item" style="top:43%; left:35%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">17</label>
  <label class="checkbox-item" style="top:41%; left:55%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">18</label>
  <label class="checkbox-item" style="top:44%; left:75%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">19</label>
  <label class="checkbox-item" style="top:46%; left:90%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">20</label>

  <label class="checkbox-item" style="top:55%; left:5%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">21</label>
  <label class="checkbox-item" style="top:58%; left:25%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">22</label>
  <label class="checkbox-item" style="top:52%; left:50%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">23</label>
  <label class="checkbox-item" style="top:57%; left:70%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">24</label>
  <label class="checkbox-item" style="top:54%; left:90%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">25</label>

  <label class="checkbox-item" style="top:65%; left:12%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">26</label>
  <label class="checkbox-item" style="top:68%; left:32%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">27</label>
  <label class="checkbox-item" style="top:66%; left:55%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">28</label>
  <label class="checkbox-item" style="top:69%; left:75%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">29</label>
  <label class="checkbox-item" style="top:67%; left:90%;"><input type="checkbox" class="accident" onclick="toggleSelected(this)">30</label>
</div>

<!-- 초기화 버튼 -->
<div style="text-align: center;">
  <button id="resetButton" onclick="resetSelections()">초기화</button>
</div>

<script>
// 체크박스 클릭하면 색 변경
function toggleSelected(checkbox) {
  const label = checkbox.parentElement;
  if (checkbox.checked) {
    label.classList.add('selected');
  } else {
    label.classList.remove('selected');
  }
  saveSelections();
  updateAll();
}

// 체크한 항목 저장
function saveSelections() {
  const selections = [];
  document.querySelectorAll('.accident').forEach((checkbox, idx) => {
    if (checkbox.checked) {
      selections.push(idx);
    }
  });
  localStorage.setItem('savedSelections', JSON.stringify(selections));
}

// 페이지 로드할 때 저장된 거 복원
function loadSelections() {
  const saved = JSON.parse(localStorage.getItem('savedSelections')) || [];
  document.querySelectorAll('.accident').forEach((checkbox, idx) => {
    if (saved.includes(idx)) {
      checkbox.checked = true;
      checkbox.parentElement.classList.add('selected');
    } else {
      checkbox.checked = false;
      checkbox.parentElement.classList.remove('selected');
    }
  });
}

// 초기화 버튼 누르면 모두 해제
function resetSelections() {
  localStorage.removeItem('savedSelections');
  document.querySelectorAll('.accident').forEach((checkbox) => {
    checkbox.checked = false;
    checkbox.parentElement.classList.remove('selected');
  });
  updateAll();
}

// 처음 로딩할 때 복원
window.onload = loadSelections;

// 계산 업데이트 함수 (필요하면 너 계산 함수 넣으면 됨)
function updateAll() {
  // 감가 계산 함수 연결 부분
}
</script>
