<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìë™ì°¨ ê°ê°€ ê³„ì‚°ê¸°</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --accent:#ff5c5c;
      --accent-2:#ff7b7b;
      --bg:#0b1220;
      --card:rgba(255,255,255,0.06);
      --card-2:rgba(255,255,255,0.08);
      --text:#e5e7eb;
      --muted:#9ca3af;
      --line:rgba(255,255,255,0.10);
      --shadow: 0 18px 40px rgba(0,0,0,0.35);
      --shadow-soft: 0 6px 18px rgba(0,0,0,0.25);
      --radius: 18px;
      --radius-sm: 14px;
      --focus: 0 0 0 4px rgba(255, 92, 92, 0.20);
    }
    *{ box-sizing:border-box; }
    body{
      font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      margin:0;
      padding:12px;
      background: radial-gradient(1200px 600px at 30% 10%, rgba(255,92,92,0.14), transparent 55%),
                  radial-gradient(800px 500px at 90% 20%, rgba(99,102,241,0.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      text-align:center;
    }

    /* Header */
    .app-header{
      max-width:760px;
      margin:0 auto 12px;
      padding:14px;
      border-radius:var(--radius);
      background: linear-gradient(135deg, rgba(255,92,92,0.16), rgba(255,255,255,0.06));
      border:1px solid rgba(255,255,255,0.10);
      box-shadow: var(--shadow-soft);
      text-align:left;
    }
    .app-title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .app-title h1{
      margin:0;
      font-size:18px;
      letter-spacing:-0.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .app-title h1 i{
      color:var(--accent);
      background: rgba(255,92,92,0.12);
      width:34px;height:34px;
      display:grid;place-items:center;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.10);
    }
    .app-sub{
      margin:8px 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    /* Toggle */
    .car-type-toggle{
      display:flex;
      gap:8px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .car-type-toggle button{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color:var(--text);
      font-weight:900;
      cursor:pointer;
      transition:.18s;
      backdrop-filter: blur(10px);
    }
    .car-type-toggle button.active{
      border-color: rgba(255,92,92,0.45);
      background: rgba(255,92,92,0.16);
      color: var(--accent);
    }

    /* Sections */
    .section{
      max-width:760px;
      margin:12px auto;
      border-radius:var(--radius);
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,0.04));
      border:1px solid rgba(255,255,255,0.10);
      box-shadow: var(--shadow);
      padding:14px;
      text-align:left;
    }
    .section h2{
      margin:0 0 12px;
      font-size:16px;
      font-weight:900;
      letter-spacing:-0.3px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .section h2 i{
      color:var(--accent);
      background: rgba(255,92,92,0.12);
      width:34px;height:34px;
      display:grid;place-items:center;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.10);
    }
    .hint{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }

    /* Fields */
    .field{ display:grid; gap:8px; margin-bottom:12px; }
    .field label{
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .field label i{ color:var(--accent); opacity:0.95; }
    input[type="text"], textarea{
      width:100%;
      padding:12px 12px;
      border-radius:var(--radius-sm);
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color:var(--text);
      font-size:14px;
      outline:none;
      transition:.15s;
    }
    input[type="text"]::placeholder, textarea::placeholder{ color: rgba(229,231,235,0.45); }
    input[type="text"]:focus, textarea:focus{
      border-color: rgba(255,92,92,0.55);
      box-shadow: var(--focus);
    }
    textarea{ resize:none; overflow:hidden; min-height:44px; }

    .price-inline{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .price-inline .suffix{
      font-weight:900;
      color:var(--muted);
    }

    /* âœ… ê²€ì°¨ê²°ê³¼(í†µí•©) */
    .result-area{
      border:1px dashed rgba(255,92,92,0.40);
      background: rgba(255,92,92,0.06);
      border-radius: var(--radius);
      padding:12px;
      margin-top:10px;
    }
    .result-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .result-title{
      font-weight:900;
      color:var(--accent);
      display:flex;
      align-items:center;
      gap:8px;
      font-size:14px;
    }
    .result-total{
      font-weight:900;
      color:var(--accent);
      font-size:13px;
      white-space:nowrap;
      text-align:right;
    }
    .result-sub{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .chips{ display:flex; flex-wrap:wrap; gap:6px; margin-top:8px; }
    .chip{
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color:var(--text);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .chip.exchange{ border-color: rgba(255,92,92,0.45); background: rgba(255,92,92,0.14); color: #ffd1d1; }
    .chip.repair{ border-color: rgba(245,158,11,0.45); background: rgba(245,158,11,0.14); color: #ffe3b3; }
    .result-list{
      margin:10px 0 0;
      padding-left:18px;
      color:var(--text);
      font-size:13px;
      line-height:1.5;
    }
    .result-list li{ margin:4px 0; color: #f3f4f6; }
    .result-empty{ margin-top:8px; font-size:13px; color: var(--muted); }

    /* Image area */
    .container{
      position:relative;
      width:100%;
      max-width:540px;
      margin:0 auto;
      border-radius: var(--radius);
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.10);
      box-shadow: var(--shadow-soft);
      background: rgba(255,255,255,0.04);
    }
    .car-image{ width:100%; display:block; }
    .checkbox-overlay{ position:absolute; inset:0; }

    /* =========================================================
       âœ… (1) í•€(ì ) ìŠ¤íƒ€ì¼ + í° í„°ì¹˜ì˜ì—­ (ëª¨ë°”ì¼ ìµœì )
       âœ… (2) ë„ìƒ‰: ì´ë¯¸ì§€ ìœ„ ê¸€ì ì œê±°(ì ë§Œ)
       âœ… (3) ì‚¬ê³ : ì  í„°ì¹˜ë¡œ ì—†ìŒâ†’êµí™˜â†’íŒê¸ˆâ†’ì—†ìŒ
       ========================================================= */
    .checkbox-item{
      position:absolute;
      transform: translate(-50%, -50%);
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      user-select:none;

      width:10px;
      height:10px;
      border-radius:50%;
      background: rgba(148,163,184,0.92);
      box-shadow: 0 2px 8px rgba(0,0,0,.40);
      transition: transform .12s ease, background .12s ease;
    }
    /* í„°ì¹˜ íˆíŠ¸ë°•ìŠ¤ í¬ê²Œ */
    .checkbox-item::before{
      content:"";
      position:absolute;
      inset:-14px;
      background:transparent;
    }
    /* ë„ìƒ‰ ì„ íƒ */
    .checkbox-item.selected{
      background: var(--accent);
      transform: translate(-50%, -50%) scale(1.25);
      box-shadow: 0 6px 16px rgba(255,92,92,.35);
    }
    /* ì‚¬ê³  ìƒíƒœ */
    .checkbox-item.exchange{
      background: var(--accent);
      transform: translate(-50%, -50%) scale(1.25);
      box-shadow: 0 6px 16px rgba(255,92,92,.35);
    }
    .checkbox-item.repair{
      background: #f59e0b;
      transform: translate(-50%, -50%) scale(1.25);
      box-shadow: 0 6px 16px rgba(245,158,11,.30);
    }

    @media (max-width:420px){
      .checkbox-item{ width:8px; height:8px; }
      .checkbox-item::before{ inset:-16px; }
    }

    /* ì„¸ë¶€ìƒíƒœ */
    .function-category{
      margin-top:14px;
      border:1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius);
      padding:12px;
      background: rgba(255,255,255,0.04);
    }
    .function-category h3{
      margin:0 0 10px;
      font-size:12px;
      font-weight:900;
      color: var(--accent-2);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .function-item{
      display:grid;
      grid-template-columns: 28px 1fr 1.2fr 110px;
      gap:8px;
      align-items:center;
      margin-bottom:10px;
      padding:10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.18);
      transition:.15s;
    }
    .function-item:has(input[type="checkbox"]:checked){
      border-color: rgba(255,92,92,0.35);
      background: rgba(255,92,92,0.08);
    }
    .function-item input[type="checkbox"]{
      width:18px;height:18px;
      accent-color: var(--accent);
    }
    .function-item input[type="text"]{
      padding:10px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color: var(--text);
      font-size:13px;
    }
    .function-item input.function-price{
      text-align:right;
      font-weight:900;
    }
    .btn-soft{
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,92,92,0.35);
      background: rgba(255,92,92,0.12);
      color: var(--text);
      font-weight: 900;
      cursor:pointer;
      transition:.15s;
      width:100%;
    }
    .btn-soft:hover{ background: rgba(255,92,92,0.18); }

    /* Bottom bar */
    .bottom-bar{
      position: sticky;
      bottom: 0;
      z-index: 50;
      max-width: 760px;
      margin: 12px auto 0;
      background: rgba(0,0,0,0.35);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      text-align:left;
    }
    .bottom-left{ display:grid; gap:2px; }
    .bottom-left .label{ font-size:11px; color:var(--muted); font-weight:900; }
    .bottom-left .value{ font-size:16px; font-weight:900; color:var(--accent); letter-spacing:-0.2px; }
    .bottom-actions{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; }
    .btn-primary{
      padding:10px 14px;
      border-radius: 12px;
      border:none;
      background: var(--accent);
      color:#fff;
      font-weight: 900;
      cursor:pointer;
    }
    .btn-ghost{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color: var(--text);
      font-weight: 900;
      cursor:pointer;
    }

    @media (max-width:560px){
      .function-item{
        grid-template-columns: 26px 1fr;
        grid-template-rows: auto auto auto;
      }
      .function-item > :nth-child(2){ grid-column: 2 / 3; }
      .function-item > :nth-child(3){ grid-column: 1 / 3; }
      .function-item > :nth-child(4){ grid-column: 1 / 3; }
      .function-item input.function-price{ text-align:left; }
      .bottom-left .value{ font-size:15px; }
      .btn-primary, .btn-ghost{ padding:10px 12px; }
    }
  </style>
</head>

<body>
  <div class="app-header">
    <div class="app-title">
      <h1><i class="fa-solid fa-car"></i> ìë™ì°¨ ê°ê°€ ê³„ì‚°ê¸°</h1>
      <div class="car-type-toggle">
        <button id="btnImported" onclick="setCarType('imported')">ìˆ˜ì…ì°¨</button>
        <button id="btnDomestic" onclick="setCarType('domestic')">êµ­ì‚°ì°¨</button>
      </div>
    </div>
    <p class="app-sub">
      ì…ì°°ê°€ ì…ë ¥ â†’ ë„ìƒ‰/ì‚¬ê³  í•€ í„°ì¹˜ â†’ ì„¸ë¶€ìƒíƒœ ê¸ˆì•¡ ì…ë ¥í•˜ë©´ <b>ê²€ì°¨ê²°ê³¼</b>ì™€ ìµœì¢…ê¸ˆì•¡ì´ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.
    </p>
  </div>

  <!-- ê°€ê²© + ê²€ì°¨ê²°ê³¼ -->
  <div class="section">
    <h2><i class="fa-solid fa-won-sign"></i> ê°€ê²©</h2>

    <div class="field">
      <label for="bidPriceInput"><i class="fa-solid fa-tag"></i> ì…ì°°ê°€</label>
      <div class="price-inline">
        <input type="text" id="bidPriceInput"
               oninput="formatInput(this); saveInput('bidPriceInput')"
               onchange="updateAll()"
               placeholder="ì˜ˆ) 12,300,000">
        <span class="suffix">ì›</span>
      </div>
    </div>

    <div id="resultArea" class="result-area" style="display:none;"></div>

    <div class="hint">
      * ì´ë¯¸ì§€ ìœ„ì—ëŠ” ì (í•€)ë§Œ ë³´ì´ë©°, ì„ íƒëœ ë¶€ìœ„ëª…/ê¸ˆì•¡ì€ <b>ê²€ì°¨ê²°ê³¼</b>ì— ì •ë¦¬ë©ë‹ˆë‹¤.
    </div>
  </div>

  <!-- ì°¨ëŸ‰ì •ë³´ -->
  <div class="section">
    <h2><i class="fas fa-car-side"></i> ì°¨ëŸ‰ì •ë³´</h2>

    <div class="field">
      <label><i class="fas fa-car"></i> ì°¨ëŸ‰ë²ˆí˜¸ &nbsp; <i class="fas fa-tachometer-alt"></i> ì£¼í–‰ê±°ë¦¬</label>
      <input type="text" id="carNumber" placeholder="ì°¨ëŸ‰ë²ˆí˜¸ / ì£¼í–‰ê±°ë¦¬ ì…ë ¥" oninput="saveInput('carNumber')">
    </div>

    <div class="field">
      <label><i class="fas fa-id-badge"></i> ì°¨ëŸ‰ëª… &nbsp; <i class="fas fa-star"></i> ì°¨ëŸ‰ë“±ê¸‰</label>
      <input type="text" id="carName" placeholder="ì°¨ëŸ‰ëª… & ë“±ê¸‰ ì…ë ¥" oninput="saveInput('carName')">
    </div>
  </div>

  <!-- ê³ ê°ê¸°ì¬ -->
  <div class="section">
    <h2><i class="fas fa-user-edit"></i> ê³ ê°ê¸°ì¬</h2>

    <div class="field">
      <label><i class="fas fa-tools"></i> ì™¸íŒ &nbsp; <i class="fas fa-dot-circle"></i> íœ ê¸°ìŠ¤</label>
      <input type="text" id="exterior" placeholder="ì™¸íŒ & íœ ê¸°ìŠ¤ ìˆ˜ëŸ‰" oninput="saveInput('exterior')">
    </div>

    <div class="field">
      <label><i class="fas fa-key"></i> ë³´ì¡°í‚¤ &nbsp; <i class="fas fa-circle-notch"></i> íƒ€ì´ì–´ìƒíƒœ</label>
      <input type="text" id="spareKey" placeholder="ë³´ì¡°í‚¤ ìœ /ë¬´ & íƒ€ì´ì–´ìƒíƒœ" oninput="saveInput('spareKey')">
    </div>

    <div class="field">
      <label><i class="fas fa-wrench"></i> ì •ë¹„ ìš”ë§</label>
      <input type="text" id="repair" placeholder="ì •ë¹„ í•„ìš”í•œ í•­ëª©ì„ ì…ë ¥" oninput="saveInput('repair')">
    </div>

    <div class="field">
      <label><i class="fas fa-comment-dots"></i> ì°¨ëŸ‰ ì¥ë‹¨ì </label>
      <textarea id="carAdvantage" placeholder="ì°¨ëŸ‰ ì¥ë‹¨ì " rows="1"
                oninput="autoResize(this); saveInput('carAdvantage')"></textarea>
    </div>

    <div class="field">
      <label><i class="fas fa-comment-dots"></i> ë©”ëª¨</label>
      <textarea id="Memo" placeholder="ë©”ëª¨ ì…ë ¥" rows="1"
                oninput="autoResize(this); saveInput('Memo')"></textarea>
    </div>
  </div>

  <!-- ë„ìƒ‰ -->
  <div class="section">
    <h2><i class="fas fa-paint-roller"></i> ë„ìƒ‰</h2>
    <div class="container">
      <img src="https://imgur.com/KeHpOPv.png" class="car-image" alt="ìë™ì°¨ ì™¸ê´€">
      <div class="checkbox-overlay" id="partSection"></div>
    </div>
    <div class="hint">ë¶€ìœ„ë¥¼ í„°ì¹˜í•˜ë©´ ì„ íƒ/í•´ì œë©ë‹ˆë‹¤. (íœ /íƒ€ì´ì–´ëŠ” ë³„ë„ ê°ê°€ ë‹¨ê°€ ì ìš©)</div>
  </div>

  <!-- ì‚¬ê³  -->
  <div class="section">
    <h2><i class="fas fa-car-burst"></i> ì‚¬ê³  ì´ë ¥</h2>
    <div class="container">
      <img src="https://imgur.com/kfizDdA.png" class="car-image" alt="ì‚¬ê³ ë¶€ìœ„ ìë™ì°¨">
      <div class="checkbox-overlay" id="accidentSection"></div>
    </div>
    <div class="hint">ë¶€ìœ„ë¥¼ í„°ì¹˜í•˜ë©´ <b>ì—†ìŒ â†’ êµí™˜ â†’ íŒê¸ˆ â†’ ì—†ìŒ</b> ìˆœì„œë¡œ ë³€ê²½ë©ë‹ˆë‹¤.</div>
  </div>

  <!-- ì„¸ë¶€ ìƒíƒœ -->
  <div class="section">
    <h2><i class="fas fa-tools"></i> ì„¸ë¶€ ìƒíƒœ</h2>

    <div class="function-category">
      <h3><i class="fa-solid fa-list-check"></i> ìµìŠ¤í…Œë¦¬ì–´&ê¸°íƒ€ PartğŸ“</h3>

      <div class="function-item">
        <input type="checkbox" data-name="ë¼ì´íŠ¸í¬ë™" onchange="updateAll()">
        <div style="font-weight:900;">ë¼ì´íŠ¸í¬ë™</div>
        <input type="text" class="function-desc" data-key="ë¼ì´íŠ¸í¬ë™-desc" oninput="saveInput('ë¼ì´íŠ¸í¬ë™-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë¼ì´íŠ¸í¬ë™-price" oninput="formatInput(this); saveInput('ë¼ì´íŠ¸í¬ë™-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì•ˆê°œë“±í¬ë™" onchange="updateAll()">
        <div style="font-weight:900;">ì•ˆê°œë“±í¬ë™</div>
        <input type="text" class="function-desc" data-key="ì•ˆê°œë“±í¬ë™-desc" oninput="saveInput('ì•ˆê°œë“±í¬ë™-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì•ˆê°œë“±í¬ë™-price" oninput="formatInput(this); saveInput('ì•ˆê°œë“±í¬ë™-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë°ë£¨ë“±í¬ë™" onchange="updateAll()">
        <div style="font-weight:900;">ë°ë£¨ë“±í¬ë™</div>
        <input type="text" class="function-desc" data-key="ë°ë£¨ë“±í¬ë™-desc" oninput="saveInput('ë°ë£¨ë“±í¬ë™-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë°ë£¨ë“±í¬ë™-price" oninput="formatInput(this); saveInput('ë°ë£¨ë“±í¬ë™-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ìë™ì°¨ê²€ì‚¬(ê¸°íƒ€)" onchange="updateAll()">
        <div style="font-weight:900;">ìë™ì°¨ê²€ì‚¬</div>
        <input type="text" class="function-desc" data-key="ìë™ì°¨ê²€ì‚¬(ê¸°íƒ€)-desc" oninput="saveInput('ìë™ì°¨ê²€ì‚¬(ê¸°íƒ€)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ìë™ì°¨ê²€ì‚¬(ê¸°íƒ€)-price" oninput="formatInput(this); saveInput('ìë™ì°¨ê²€ì‚¬(ê¸°íƒ€)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="êµ¬ë³€ì—¬ë¶€(ê¸°íƒ€)" onchange="updateAll()">
        <div style="font-weight:900;">êµ¬ë³€ì—¬ë¶€</div>
        <input type="text" class="function-desc" data-key="êµ¬ë³€ì—¬ë¶€(ê¸°íƒ€)-desc" oninput="saveInput('êµ¬ë³€ì—¬ë¶€(ê¸°íƒ€)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="êµ¬ë³€ì—¬ë¶€(ê¸°íƒ€)-price" oninput="formatInput(this); saveInput('êµ¬ë³€ì—¬ë¶€(ê¸°íƒ€)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div id="exterior-items"></div>
      <button class="btn-soft" onclick="addExtraItem('ìµìŠ¤í…Œë¦¬ì–´')">+ ê¸°íƒ€ í•­ëª© ì¶”ê°€</button>
    </div>

    <div class="function-category">
      <h3><i class="fa-solid fa-list-check"></i> ì—”ì§„ PartğŸ“</h3>

      <div class="function-item">
        <input type="checkbox" data-name="ê³µíšŒì „ìƒíƒœ" onchange="updateAll()">
        <div style="font-weight:900;">ê³µíšŒì „ìƒíƒœ</div>
        <input type="text" class="function-desc" data-key="ê³µíšŒì „ìƒíƒœ-desc" oninput="saveInput('ê³µíšŒì „ìƒíƒœ-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ê³µíšŒì „ìƒíƒœ-price" oninput="formatInput(this); saveInput('ê³µíšŒì „ìƒíƒœ-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì˜¤ì¼ëˆ„ìœ " onchange="updateAll()">
        <div style="font-weight:900;">ì˜¤ì¼ëˆ„ìœ </div>
        <input type="text" class="function-desc" data-key="ì˜¤ì¼ëˆ„ìœ -desc" oninput="saveInput('ì˜¤ì¼ëˆ„ìœ -desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì˜¤ì¼ëˆ„ìœ -price" oninput="formatInput(this); saveInput('ì˜¤ì¼ëˆ„ìœ -price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜" onchange="updateAll()">
        <div style="font-weight:900;">ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜</div>
        <input type="text" class="function-desc" data-key="ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜-desc" oninput="saveInput('ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜-price" oninput="formatInput(this); saveInput('ëƒ‰ê°ìˆ˜ëˆ„ìˆ˜-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì†Œëª¨í’ˆ(ì—”ì§„)" onchange="updateAll()">
        <div style="font-weight:900;">ì†Œëª¨í’ˆ</div>
        <input type="text" class="function-desc" data-key="ì†Œëª¨í’ˆ(ì—”ì§„)-desc" oninput="saveInput('ì†Œëª¨í’ˆ(ì—”ì§„)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì†Œëª¨í’ˆ(ì—”ì§„)-price" oninput="formatInput(this); saveInput('ì†Œëª¨í’ˆ(ì—”ì§„)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div id="engine-items"></div>
      <button class="btn-soft" onclick="addExtraItem('ì—”ì§„')">+ ê¸°íƒ€ í•­ëª© ì¶”ê°€</button>
    </div>

    <div class="function-category">
      <h3><i class="fa-solid fa-list-check"></i> ë¯¸ì…˜ PartğŸ“</h3>

      <div class="function-item">
        <input type="checkbox" data-name="ì˜¤ì¼ëˆ„ìœ (ë¯¸ì…˜)" onchange="updateAll()">
        <div style="font-weight:900;">ì˜¤ì¼ëˆ„ìœ </div>
        <input type="text" class="function-desc" data-key="ì˜¤ì¼ëˆ„ìœ (ë¯¸ì…˜)-desc" oninput="saveInput('ì˜¤ì¼ëˆ„ìœ (ë¯¸ì…˜)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì˜¤ì¼ëˆ„ìœ (ë¯¸ì…˜)-price" oninput="formatInput(this); saveInput('ì˜¤ì¼ëˆ„ìœ (ë¯¸ì…˜)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì†Œëª¨í’ˆ(ë¯¸ì…˜)" onchange="updateAll()">
        <div style="font-weight:900;">ì†Œëª¨í’ˆ</div>
        <input type="text" class="function-desc" data-key="ì†Œëª¨í’ˆ(ë¯¸ì…˜)-desc" oninput="saveInput('ì†Œëª¨í’ˆ(ë¯¸ì…˜)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì†Œëª¨í’ˆ(ë¯¸ì…˜)-price" oninput="formatInput(this); saveInput('ì†Œëª¨í’ˆ(ë¯¸ì…˜)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div id="mission-items"></div>
      <button class="btn-soft" onclick="addExtraItem('ë¯¸ì…˜')">+ ê¸°íƒ€ í•­ëª© ì¶”ê°€</button>
    </div>

    <div class="function-category">
      <h3><i class="fa-solid fa-list-check"></i> í•˜ì²´ PartğŸ“</h3>

      <div class="function-item">
        <input type="checkbox" data-name="ì‡¼ë²„" onchange="updateAll()">
        <div style="font-weight:900;">ì‡¼ë²„</div>
        <input type="text" class="function-desc" data-key="ì‡¼ë²„-desc" oninput="saveInput('ì‡¼ë²„-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì‡¼ë²„-price" oninput="formatInput(this); saveInput('ì‡¼ë²„-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì„œìŠ¤íœì…˜" onchange="updateAll()">
        <div style="font-weight:900;">ì„œìŠ¤íœì…˜(ì•”,ë§í¬)</div>
        <input type="text" class="function-desc" data-key="ì„œìŠ¤íœì…˜-desc" oninput="saveInput('ì„œìŠ¤íœì…˜-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì„œìŠ¤íœì…˜-price" oninput="formatInput(this); saveInput('ì„œìŠ¤íœì…˜-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë“±ì†ì¡°ì¸íŠ¸" onchange="updateAll()">
        <div style="font-weight:900;">ë“±ì†ì¡°ì¸íŠ¸</div>
        <input type="text" class="function-desc" data-key="ë“±ì†ì¡°ì¸íŠ¸-desc" oninput="saveInput('ë“±ì†ì¡°ì¸íŠ¸-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë“±ì†ì¡°ì¸íŠ¸-price" oninput="formatInput(this); saveInput('ë“±ì†ì¡°ì¸íŠ¸-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì›œê¸°ì–´" onchange="updateAll()">
        <div style="font-weight:900;">ì›œê¸°ì–´</div>
        <input type="text" class="function-desc" data-key="ì›œê¸°ì–´-desc" oninput="saveInput('ì›œê¸°ì–´-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì›œê¸°ì–´-price" oninput="formatInput(this); saveInput('ì›œê¸°ì–´-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë””ìŠ¤í¬" onchange="updateAll()">
        <div style="font-weight:900;">ë””ìŠ¤í¬(íŒ¨ë“œ)</div>
        <input type="text" class="function-desc" data-key="ë””ìŠ¤í¬-desc" oninput="saveInput('ë””ìŠ¤í¬-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë””ìŠ¤í¬-price" oninput="formatInput(this); saveInput('ë””ìŠ¤í¬-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë¨¸í”ŒëŸ¬" onchange="updateAll()">
        <div style="font-weight:900;">ë¨¸í”ŒëŸ¬</div>
        <input type="text" class="function-desc" data-key="ë¨¸í”ŒëŸ¬-desc" oninput="saveInput('ë¨¸í”ŒëŸ¬-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë¨¸í”ŒëŸ¬-price" oninput="formatInput(this); saveInput('ë¨¸í”ŒëŸ¬-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì†Œëª¨í’ˆ(í•˜ì²´)" onchange="updateAll()">
        <div style="font-weight:900;">ì†Œëª¨í’ˆ</div>
        <input type="text" class="function-desc" data-key="ì†Œëª¨í’ˆ(í•˜ì²´)-desc" oninput="saveInput('ì†Œëª¨í’ˆ(í•˜ì²´)-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì†Œëª¨í’ˆ(í•˜ì²´)-price" oninput="formatInput(this); saveInput('ì†Œëª¨í’ˆ(í•˜ì²´)-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div id="under-items"></div>
      <button class="btn-soft" onclick="addExtraItem('í•˜ì²´')">+ ê¸°íƒ€ í•­ëª© ì¶”ê°€</button>
    </div>

    <div class="function-category">
      <h3><i class="fa-solid fa-list-check"></i> ì¸í…Œë¦¬ì–´ PartğŸ“</h3>

      <div class="function-item">
        <input type="checkbox" data-name="ì‹œíŠ¸" onchange="updateAll()">
        <div style="font-weight:900;">ì‹œíŠ¸ìƒíƒœ</div>
        <input type="text" class="function-desc" data-key="ì‹œíŠ¸-desc" oninput="saveInput('ì‹œíŠ¸-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì‹œíŠ¸-price" oninput="formatInput(this); saveInput('ì‹œíŠ¸-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì‹¤ë‚´ì»¨ë””ì…˜" onchange="updateAll()">
        <div style="font-weight:900;">ì‹¤ë‚´ìƒíƒœ</div>
        <input type="text" class="function-desc" data-key="ì‹¤ë‚´ì»¨ë””ì…˜-desc" oninput="saveInput('ì‹¤ë‚´ì»¨ë””ì…˜-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì‹¤ë‚´ì»¨ë””ì…˜-price" oninput="formatInput(this); saveInput('ì‹¤ë‚´ì»¨ë””ì…˜-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ê³„ê¸°íŒ" onchange="updateAll()">
        <div style="font-weight:900;">ê³„ê¸°íŒ</div>
        <input type="text" class="function-desc" data-key="ê³„ê¸°íŒ-desc" oninput="saveInput('ê³„ê¸°íŒ-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ê³„ê¸°íŒ-price" oninput="formatInput(this); saveInput('ê³„ê¸°íŒ-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë“±í™”ë¥˜" onchange="updateAll()">
        <div style="font-weight:900;">ë“±í™”ë¥˜</div>
        <input type="text" class="function-desc" data-key="ë“±í™”ë¥˜-desc" oninput="saveInput('ë“±í™”ë¥˜-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë“±í™”ë¥˜-price" oninput="formatInput(this); saveInput('ë“±í™”ë¥˜-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì—ì–´ì»¨íˆí„°" onchange="updateAll()">
        <div style="font-weight:900;">ëƒ‰ë‚œë°©ë¥˜</div>
        <input type="text" class="function-desc" data-key="ì—ì–´ì»¨íˆí„°-desc" oninput="saveInput('ì—ì–´ì»¨íˆí„°-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì—ì–´ì»¨íˆí„°-price" oninput="formatInput(this); saveInput('ì—ì–´ì»¨íˆí„°-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì˜¤ë””ì˜¤" onchange="updateAll()">
        <div style="font-weight:900;">ì˜¤ë””ì˜¤ê³„í†µ</div>
        <input type="text" class="function-desc" data-key="ì˜¤ë””ì˜¤-desc" oninput="saveInput('ì˜¤ë””ì˜¤-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì˜¤ë””ì˜¤-price" oninput="formatInput(this); saveInput('ì˜¤ë””ì˜¤-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë¯¸ëŸ¬ì°½ë¬¸" onchange="updateAll()">
        <div style="font-weight:900;">ë¯¸ëŸ¬&ì°½ë¬¸</div>
        <input type="text" class="function-desc" data-key="ë¯¸ëŸ¬ì°½ë¬¸-desc" oninput="saveInput('ë¯¸ëŸ¬ì°½ë¬¸-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë¯¸ëŸ¬ì°½ë¬¸-price" oninput="formatInput(this); saveInput('ë¯¸ëŸ¬ì°½ë¬¸-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ë²„íŠ¼ë¥˜" onchange="updateAll()">
        <div style="font-weight:900;">ë²„íŠ¼ë¥˜ì‘ë™</div>
        <input type="text" class="function-desc" data-key="ë²„íŠ¼ë¥˜-desc" oninput="saveInput('ë²„íŠ¼ë¥˜-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ë²„íŠ¼ë¥˜-price" oninput="formatInput(this); saveInput('ë²„íŠ¼ë¥˜-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ì¬íŒ…" onchange="updateAll()">
        <div style="font-weight:900;">ì¬íŒ…ìƒíƒœ</div>
        <input type="text" class="function-desc" data-key="ì¬íŒ…-desc" oninput="saveInput('ì¬íŒ…-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ì¬íŒ…-price" oninput="formatInput(this); saveInput('ì¬íŒ…-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="ìœ ë¦¬í¬ë™" onchange="updateAll()">
        <div style="font-weight:900;">ìœ ë¦¬í¬ë™</div>
        <input type="text" class="function-desc" data-key="ìœ ë¦¬í¬ë™-desc" oninput="saveInput('ìœ ë¦¬í¬ë™-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="ìœ ë¦¬í¬ë™-price" oninput="formatInput(this); saveInput('ìœ ë¦¬í¬ë™-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div class="function-item">
        <input type="checkbox" data-name="íŠ¸ë í¬ìƒíƒœ" onchange="updateAll()">
        <div style="font-weight:900;">íŠ¸ë í¬ìƒíƒœ</div>
        <input type="text" class="function-desc" data-key="íŠ¸ë í¬ìƒíƒœ-desc" oninput="saveInput('íŠ¸ë í¬ìƒíƒœ-desc'); updateAll()" placeholder="ë‚´ìš©">
        <input type="text" class="function-price" data-key="íŠ¸ë í¬ìƒíƒœ-price" oninput="formatInput(this); saveInput('íŠ¸ë í¬ìƒíƒœ-price'); updateAll()" placeholder="ê¸ˆì•¡(ì›)">
      </div>

      <div id="interior-items"></div>
      <button class="btn-soft" onclick="addExtraItem('ì¸í…Œë¦¬ì–´')">+ ê¸°íƒ€ í•­ëª© ì¶”ê°€</button>
    </div>
  </div>

  <!-- Bottom bar -->
  <div class="bottom-bar">
    <div class="bottom-left">
      <div class="label">ìµœì¢…ê¸ˆì•¡</div>
      <div class="value"><span id="finalPrice">0</span>ì›</div>
    </div>
    <div class="bottom-actions">
      <button class="btn-ghost" onclick="window.scrollTo({top:0, behavior:'smooth'})">ë§¨ìœ„ë¡œ</button>
      <button class="btn-primary" onclick="resetAll()">ì´ˆê¸°í™”</button>
    </div>
  </div>

  <script>
    // âœ… ê°€ê²©(êµ­ì‚°/ìˆ˜ì… í† ê¸€)
    const PRICE = { partPrice: 180000, wheelPrice: 100000, tirePrice: 90000 };

    // âœ… ë°ì´í„°(ì¢Œí‘œ/ì´ë¦„)
    const DATA = {
      partNames: [
        { key:"front_bumper", name:"ì•ë²”í¼", top:"2%", left:"53%" },
        { key:"hood", name:"í›„ë“œ", top:"15%", left:"52%" },
        { key:"f_fender_l", name:"íœ€ë‹¤(ì¢Œ)", top:"20%", left:"24%" },
        { key:"f_fender_r", name:"íœ€ë‹¤(ìš°)", top:"20%", left:"86%" },
        { key:"mirror_l", name:"ì‚¬ì´ë“œë¯¸ëŸ¬(ì¢Œ)", top:"37%", left:"40%" },
        { key:"mirror_r", name:"ì‚¬ì´ë“œë¯¸ëŸ¬(ìš°)", top:"37%", left:"74%" },
        { key:"f_door_l", name:"ì•ë¬¸(ì¢Œ)", top:"40%", left:"21%" },
        { key:"f_door_r", name:"ì•ë¬¸(ìš°)", top:"40%", left:"87%" },
        { key:"r_door_l", name:"ë’·ë¬¸(ì¢Œ)", top:"60%", left:"21%" },
        { key:"r_door_r", name:"ë’·ë¬¸(ìš°)", top:"60%", left:"87%" },
        { key:"r_fender_l", name:"íœ€ë‹¤(ì¢Œ)", top:"83%", left:"25%" },
        { key:"r_fender_r", name:"íœ€ë‹¤(ìš°)", top:"83%", left:"85%" },
        { key:"roof", name:"ë£¨í”„", top:"60%", left:"52%" },
        { key:"trunk", name:"íŠ¸ë í¬", top:"90%", left:"52%" },
        { key:"rear_bumper", name:"ë’·ë²”í¼", top:"99%", left:"52%" },
        { key:"side_sill_l", name:"ì‚¬ì´ë“œì‹¤(ì¢Œ)", top:"50%", left:"11%" },
        { key:"side_sill_r", name:"ì‚¬ì´ë“œì‹¤(ìš°)", top:"55%", left:"94%" },
        { key:"pillar_l", name:"í•„ëŸ¬(ì¢Œ)", top:"55%", left:"32%" },
        { key:"pillar_r", name:"í•„ëŸ¬(ìš°)", top:"55%", left:"75%" },
        { key:"wheel_fl", name:"íœ (FL)", top:"20%", left:"10%" },
        { key:"wheel_fr", name:"íœ (FR)", top:"20%", left:"94%" },
        { key:"wheel_rl", name:"íœ (RL)", top:"75%", left:"10%" },
        { key:"wheel_rr", name:"íœ (RR)", top:"76%", left:"94%" },
        { key:"tire_fl", name:"íƒ€ì´ì–´(FL)", top:"27%", left:"12%" },
        { key:"tire_fr", name:"íƒ€ì´ì–´(FR)", top:"29%", left:"94%" },
        { key:"tire_rl", name:"íƒ€ì´ì–´(RL)", top:"82%", left:"12%" },
        { key:"tire_rr", name:"íƒ€ì´ì–´(RR)", top:"85%", left:"94%" }
      ],
      accidentParts: [
        { key:"acc_hood", name:"í›„ë“œ", rate:4, top:'2%', left:'50%' },
        { key:"acc_fender_l", name:"íœ€ë‹¤(ì¢Œ)", rate:3, top:'18%', left:'20%' },
        { key:"acc_fender_r", name:"íœ€ë‹¤(ìš°)", rate:3, top:'18%', left:'88%' },
        { key:"acc_f_door_l", name:"ì•ë¬¸(ì¢Œ)", rate:6, top:'40%', left:'17%' },
        { key:"acc_f_door_r", name:"ì•ë¬¸(ìš°)", rate:4, top:'40%', left:'87%' },
        { key:"acc_r_door_l", name:"ë’·ë¬¸(ì¢Œ)", rate:4, top:'62%', left:'17%' },
        { key:"acc_r_door_r", name:"ë’·ë¬¸(ìš°)", rate:4, top:'62%', left:'87%' },
        { key:"acc_f_panel", name:"F.íŒ¨ë„", rate:5, top:'9%', left:'50%' },
        { key:"acc_in_sa_l", name:"ì¸ì‚¬(ì¢Œ)", rate:3, top:'16%', left:'38%' },
        { key:"acc_side_l_1", name:"ì‚¬ì´ë“œ(ì¢Œ)", rate:4, top:'21%', left:'47%' },
        { key:"acc_wheelhouse_l_1", name:"íœ í•˜ìš°ìŠ¤(ì¢Œ)", rate:7, top:'26%', left:'38%' },
        { key:"acc_in_sa_r", name:"ì¸ì‚¬(ìš°)", rate:3, top:'16%', left:'64%' },
        { key:"acc_side_r_1", name:"ì‚¬ì´ë“œ(ìš°)", rate:4, top:'21%', left:'58%' },
        { key:"acc_wheelhouse_r_1", name:"íœ í•˜ìš°ìŠ¤(ìš°)", rate:7, top:'27%', left:'64%' },
        { key:"acc_pillar_l", name:"í•„ëŸ¬(ì¢Œ)", rate:5, top:'55%', left:'30%' },
        { key:"acc_pillar_r", name:"í•„ëŸ¬(ìš°)", rate:5, top:'55%', left:'78%' },
        { key:"acc_sill_l", name:"ì‚¬ì´ë“œì‹¤(ì¢Œ)", rate:4, top:'55%', left:'7%' },
        { key:"acc_sill_r", name:"ì‚¬ì´ë“œì‹¤(ìš°)", rate:4, top:'55%', left:'93%' },
        { key:"acc_crossmember", name:"í¬ë¡œìŠ¤ë©¤ë²„", rate:5, top:'33%', left:'50%' },
        { key:"acc_dashpanel", name:"ëŒ€ì‰¬íŒ¨ë„", rate:4, top:'39%', left:'50%' },
        { key:"acc_floorpanel", name:"í”Œë¡œì–´íŒ¨ë„", rate:5, top:'50%', left:'50%' },
        { key:"acc_wheelhouse_l_2", name:"íœ í•˜ìš°ìŠ¤(ì¢Œ)", rate:5, top:'81%', left:'38%' },
        { key:"acc_side_l_2", name:"ì‚¬ì´ë“œ(ì¢Œ)", rate:5, top:'88%', left:'40%' },
        { key:"acc_traypkg", name:"íŠ¸ë ˆì´íŒ¨í‚¤ì§€", rate:4, top:'75%', left:'50%' },
        { key:"acc_side_r_2", name:"ì‚¬ì´ë“œ(ìš°)", rate:5, top:'86%', left:'61%' },
        { key:"acc_wheelhouse_r_2", name:"íœ í•˜ìš°ìŠ¤(ìš°)", rate:7, top:'81%', left:'66%' },
        { key:"acc_roofpanel", name:"ë£¨í”„íŒ¨ë„", rate:8, top:'60%', left:'50%' },
        { key:"acc_trunkfloor", name:"íŠ¸ë í¬í”Œë¡œì–´", rate:4, top:'90%', left:'52%' },
        { key:"acc_r_panel", name:"R.íŒ¨ë„", rate:4, top:'97%', left:'63%' },
        { key:"acc_trunk", name:"íŠ¸ë í¬", rate:4, top:'97%', left:'40%' },
        { key:"acc_quarter_l", name:"ì¿¼í„°(ì¢Œ)", rate:5, top:'85%', left:'22%' },
        { key:"acc_quarter_r", name:"ì¿¼í„°(ìš°)", rate:5, top:'85%', left:'85%' }
      ]
    };

    // âœ… ë™ì  ê¸°íƒ€ í•­ëª©
    const extraCounters = { 'ìµìŠ¤í…Œë¦¬ì–´':0,'ì—”ì§„':0,'ë¯¸ì…˜':0,'í•˜ì²´':0,'ì¸í…Œë¦¬ì–´':0 };

    function addExtraItem(category, savedName=null){
      const containerId = {
        'ìµìŠ¤í…Œë¦¬ì–´':'exterior-items','ì—”ì§„':'engine-items','ë¯¸ì…˜':'mission-items','í•˜ì²´':'under-items','ì¸í…Œë¦¬ì–´':'interior-items'
      }[category];
      const container = document.getElementById(containerId);
      if(!container) return;

      const index = ++extraCounters[category];
      const name = savedName || `ê¸°íƒ€${index}(${category})`;

      const item = document.createElement('div');
      item.className='function-item';
      item.innerHTML = `
        <input type="checkbox" data-name="${name}" onchange="updateAll()">
        <div style="font-weight:900;">${name}</div>
        <input type="text" class="function-desc" data-key="${name}-desc" placeholder="ë‚´ìš©" oninput="saveInput('${name}-desc'); updateAll()">
        <input type="text" class="function-price" data-key="${name}-price" placeholder="ê¸ˆì•¡(ì›)" oninput="formatInput(this); saveInput('${name}-price'); updateAll()">
        <button class="btn-soft" onclick="this.parentElement.remove(); localStorage.removeItem('${name}-desc'); localStorage.removeItem('${name}-price'); updateAll(); saveExtraItems();">ì‚­ì œ</button>
      `;
      container.appendChild(item);
      saveExtraItems();
    }

    function saveExtraItems(){
      const categories=['ìµìŠ¤í…Œë¦¬ì–´','ì—”ì§„','ë¯¸ì…˜','í•˜ì²´','ì¸í…Œë¦¬ì–´'];
      const saved={};
      categories.forEach(category=>{
        const containerId = {
          'ìµìŠ¤í…Œë¦¬ì–´':'exterior-items','ì—”ì§„':'engine-items','ë¯¸ì…˜':'mission-items','í•˜ì²´':'under-items','ì¸í…Œë¦¬ì–´':'interior-items'
        }[category];
        const container = document.getElementById(containerId);
        const names = Array.from(container.querySelectorAll('input[type="checkbox"]')).map(cb=>cb.dataset.name);
        saved[category]=names;
      });
      localStorage.setItem('dynamicExtraItems', JSON.stringify(saved));
    }

    function loadExtraItems(){
      const saved = JSON.parse(localStorage.getItem('dynamicExtraItems') || '{}');
      Object.keys(saved).forEach(category=>{
        saved[category].forEach(name=>addExtraItem(category, name));
      });
    }

    function resetExtraItems(){
      ['exterior-items','engine-items','mission-items','under-items','interior-items'].forEach(id=>{
        const c=document.getElementById(id);
        if(c) c.innerHTML='';
      });
      localStorage.removeItem('dynamicExtraItems');
    }

    // âœ… ì €ì¥/ë¡œë“œ
    function saveInput(id){
      const el = document.getElementById(id);
      if(el) localStorage.setItem(id, el.value);

      document.querySelectorAll('.function-price, .function-desc').forEach(input=>{
        const key = input.dataset.key;
        if(key) localStorage.setItem(key, input.value);
      });
    }

    function loadInputs(){
      const baseKeys=['bidPriceInput','carNumber','carName','exterior','spareKey','repair','carAdvantage','Memo'];
      baseKeys.forEach(id=>{
        const el=document.getElementById(id);
        if(el && localStorage.getItem(id)) el.value=localStorage.getItem(id);
      });

      document.querySelectorAll('.function-price, .function-desc').forEach(input=>{
        const key=input.dataset.key;
        if(key && localStorage.getItem(key)) input.value=localStorage.getItem(key);
      });

      autoResize(document.getElementById('carAdvantage'));
      autoResize(document.getElementById('Memo'));
    }

    // ìˆ«ì
    function formatInput(input){
      input.value = input.value.replace(/[^\d]/g,'').replace(/\B(?=(\d{3})+(?!\d))/g,',');
    }
    function getNumericValue(value){
      return Number(String(value).replaceAll(',','')) || 0;
    }

    function autoResize(textarea){
      if(!textarea) return;
      textarea.style.height='auto';
      textarea.style.height = textarea.scrollHeight + 'px';
    }

    // ì‚¬ê³  state helper
    function setAccidentState(el, state){
      el.dataset.state = state || '';
      el.classList.remove('exchange','repair');
      if(state) el.classList.add(state);
      el.setAttribute('aria-pressed', state ? 'true' : 'false');
    }

    // âœ… (2) ë„ìƒ‰: í•€ë§Œ í‘œì‹œ(í…ìŠ¤íŠ¸ X) + í„°ì¹˜ë¡œ ì„ íƒ/í•´ì œ
    function renderPartItems(){
      const partSection=document.getElementById('partSection');
      partSection.innerHTML='';

      DATA.partNames.forEach(({key,name,top,left})=>{
        const el=document.createElement('div');
        el.className='checkbox-item part-item';
        el.style.top=top;
        el.style.left=left;
        el.dataset.key=key;
        el.dataset.name=name;
        el.setAttribute('role','button');
        el.setAttribute('aria-label', `ë„ìƒ‰: ${name}`);
        el.setAttribute('aria-pressed','false');

        el.addEventListener('click', ()=>{
          el.classList.toggle('selected');
          el.setAttribute('aria-pressed', el.classList.contains('selected') ? 'true' : 'false');
          updateAll();
          saveCheckboxState();
        });

        partSection.appendChild(el);
      });
    }

    // âœ… (3) ì‚¬ê³ : í•€ í„°ì¹˜ë¡œ ì—†ìŒâ†’êµí™˜â†’íŒê¸ˆâ†’ì—†ìŒ
    function renderAccidentItems(){
      const accidentSection=document.getElementById('accidentSection');
      accidentSection.innerHTML='';

      DATA.accidentParts.forEach(({key,name,rate,top,left})=>{
        const el=document.createElement('div');
        el.className='checkbox-item acc-item';
        el.style.top=top;
        el.style.left=left;
        el.dataset.key=key || name;
        el.dataset.name=name;
        el.dataset.rate=String(rate);
        el.dataset.state='';
        el.setAttribute('role','button');
        el.setAttribute('aria-label', `ì‚¬ê³ : ${name}`);
        el.setAttribute('aria-pressed','false');

        el.addEventListener('click', ()=>{
          const cur = el.dataset.state || '';
          const next = (cur === '') ? 'exchange' : (cur === 'exchange' ? 'repair' : '');
          setAccidentState(el, next);
          updateAll();
          saveCheckboxState();
        });

        accidentSection.appendChild(el);
      });
    }

    function renderAllOverlays(){
      renderPartItems();
      renderAccidentItems();
    }

    // âœ… ì²´í¬ ìƒíƒœ ì €ì¥/ë¡œë“œ(ë„ìƒ‰/ì‚¬ê³ /ì„¸ë¶€ì²´í¬)
    function saveCheckboxState(){
      const states={ paint:{}, accidents:{}, functions:{} };

      document.querySelectorAll('.part-item').forEach(el=>{
        states.paint[el.dataset.key] = el.classList.contains('selected');
      });

      document.querySelectorAll('.acc-item').forEach(el=>{
        states.accidents[el.dataset.key] = el.dataset.state || '';
      });

      document.querySelectorAll(".function-item input[type='checkbox']").forEach(cb=>{
        states.functions[cb.dataset.name]=cb.checked;
      });

      localStorage.setItem('checkboxStates', JSON.stringify(states));
    }

    function loadCheckboxState(){
      const states = JSON.parse(localStorage.getItem('checkboxStates') || '{}');

      const paintStates=states.paint||{};
      document.querySelectorAll('.part-item').forEach(el=>{
        const on = paintStates[el.dataset.key] === true;
        el.classList.toggle('selected', on);
        el.setAttribute('aria-pressed', on ? 'true' : 'false');
      });

      const accStates=states.accidents||{};
      document.querySelectorAll('.acc-item').forEach(el=>{
        const st = accStates[el.dataset.key] || '';
        setAccidentState(el, st);
      });

      const fnStates=states.functions||{};
      document.querySelectorAll(".function-item input[type='checkbox']").forEach(cb=>{
        if(fnStates[cb.dataset.name] !== undefined) cb.checked = fnStates[cb.dataset.name];
      });
    }

    // âœ… ê²€ì°¨ê²°ê³¼ ë Œë”
    function renderResultBox({selectedPaint, selectedAccidents, deductionLines, totalDiscount}){
      const box = document.getElementById('resultArea');
      const hasAny = (selectedPaint.length || selectedAccidents.length || deductionLines.length);

      if(!hasAny){
        box.style.display='none';
        box.innerHTML='';
        return;
      }

      const paintChips = selectedPaint.length
        ? `<div class="chips">${selectedPaint.map(n=>`<span class="chip"><i class="fa-solid fa-paint-roller"></i>${n}</span>`).join('')}</div>`
        : `<div class="result-empty">ì„ íƒ ì—†ìŒ</div>`;

      const accidentChips = selectedAccidents.length
        ? `<div class="chips">${
            selectedAccidents.map(a=>{
              const cls = a.state === 'exchange' ? 'exchange' : 'repair';
              const label = a.state === 'exchange' ? 'êµí™˜' : 'íŒê¸ˆ';
              const icon = a.state === 'exchange' ? 'fa-solid fa-arrows-rotate' : 'fa-solid fa-screwdriver-wrench';
              return `<span class="chip ${cls}"><i class="${icon}"></i>${a.name} Â· ${label}</span>`;
            }).join('')
          }</div>`
        : `<div class="result-empty">ì„ íƒ ì—†ìŒ</div>`;

      const detailList = deductionLines.length
        ? `<ul class="result-list">${deductionLines.map(x=>`<li>${x}</li>`).join('')}</ul>`
        : `<div class="result-empty">ì„ íƒ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;

      box.innerHTML = `
        <div class="result-head">
          <div class="result-title"><i class="fa-solid fa-clipboard-check"></i> ê²€ì°¨ê²°ê³¼</div>
          <div class="result-total">ê°ê°€ í•©ê³„: -${totalDiscount.toLocaleString()}ì›</div>
        </div>

        <div class="result-sub"><i class="fa-solid fa-paint-roller"></i> ë„ìƒ‰ (${selectedPaint.length})</div>
        ${paintChips}

        <div class="result-sub"><i class="fa-solid fa-car-burst"></i> ì‚¬ê³  (${selectedAccidents.length})</div>
        ${accidentChips}

        <div class="result-sub"><i class="fa-solid fa-list"></i> ê°ê°€ ë‚´ì—­</div>
        ${detailList}
      `;
      box.style.display='block';
    }

    // âœ… ê³„ì‚°
    function updateAll(){
      const bidPrice = getNumericValue(document.getElementById('bidPriceInput').value) || 0;

      let paintDiscount=0, accidentDiscount=0, functionDiscount=0;
      const deductionLines=[];
      const selectedPaint=[];
      const selectedAccidents=[];

      // ë„ìƒ‰
      document.querySelectorAll('.part-item').forEach(el=>{
        if(el.classList.contains('selected')){
          const name = el.dataset.name;
          selectedPaint.push(name);

          let discount=0;
          if(name.includes('íƒ€ì´ì–´')) discount = PRICE.tirePrice;
          else if(name.includes('íœ ')) discount = PRICE.wheelPrice;
          else discount = PRICE.partPrice;

          paintDiscount += discount;
          deductionLines.push(`[ë„ìƒ‰] ${name}: -${discount.toLocaleString()}ì›`);
        }
      });

      // ì‚¬ê³ 
      document.querySelectorAll('#accidentSection .acc-item').forEach(el=>{
        const name = el.dataset.name;
        const rate = Number(el.dataset.rate);
        const state = el.dataset.state || '';

        if(state === 'exchange' || state === 'repair'){
          selectedAccidents.push({name, state});

          const appliedRate = state === 'exchange' ? rate : (rate - 1);
          const discount = Math.round(bidPrice * (appliedRate / 100));

          accidentDiscount += discount;
          deductionLines.push(`[ì‚¬ê³ ] ${name} (${state === 'exchange' ? 'êµí™˜' : 'íŒê¸ˆ'}): -${discount.toLocaleString()}ì›`);
        }
      });

      // ì„¸ë¶€ìƒíƒœ (ë‚´ìš©ê¹Œì§€)
      document.querySelectorAll('.function-item').forEach(item=>{
        const checkbox = item.querySelector('input[type="checkbox"]');
        if(!checkbox) return;

        const name = checkbox.dataset.name;
        const priceInput = item.querySelector('.function-price');
        const descInput  = item.querySelector('.function-desc');

        const price = getNumericValue(priceInput?.value || '');
        const desc  = (descInput?.value || '').trim();

        if(checkbox.checked && price > 0){
          functionDiscount += price;
          const descText = desc ? ` / ${desc}` : '';
          deductionLines.push(`[ì„¸ë¶€] ${name}${descText}: -${price.toLocaleString()}ì›`);
        }
      });

      const totalDiscount = paintDiscount + accidentDiscount + functionDiscount;
      const finalPrice = Math.max(0, Math.round(bidPrice - totalDiscount));
      document.getElementById('finalPrice').textContent = finalPrice.toLocaleString();

      renderResultBox({ selectedPaint, selectedAccidents, deductionLines, totalDiscount });
      saveCheckboxState();
    }

    // êµ­ì‚°/ìˆ˜ì…
    function setCarType(type){
      if(type === 'domestic'){
        PRICE.partPrice = 130000;
        PRICE.tirePrice = 90000;
      }else{
        PRICE.partPrice = 180000;
        PRICE.tirePrice = 90000;
      }
      localStorage.setItem('carType', type);
      updateCarTypeButtons(type);
      updateAll();
    }
    function updateCarTypeButtons(selected){
      document.getElementById('btnDomestic').classList.toggle('active', selected === 'domestic');
      document.getElementById('btnImported').classList.toggle('active', selected === 'imported');
    }

    // ì´ˆê¸°í™”
    function resetAll(){
      localStorage.clear();

      document.querySelectorAll("input[type='text']").forEach(i=>i.value='');
      document.querySelectorAll("textarea").forEach(t=>{ t.value=''; autoResize(t); });
      document.querySelectorAll(".function-item input[type='checkbox']").forEach(cb=>cb.checked=false);

      document.querySelectorAll(".part-item").forEach(el=>{
        el.classList.remove('selected');
        el.setAttribute('aria-pressed','false');
      });

      document.querySelectorAll(".acc-item").forEach(el=>setAccidentState(el,''));

      const box=document.getElementById('resultArea');
      box.innerHTML='';
      box.style.display='none';

      resetExtraItems();
      updateAll();
    }

    window.addEventListener('DOMContentLoaded', ()=>{
      renderAllOverlays();
      loadExtraItems();
      loadInputs();
      loadCheckboxState();

      const savedType = localStorage.getItem('carType') || 'imported';
      setCarType(savedType);

      updateAll();
    });

    window.addEventListener('beforeunload', saveExtraItems);
  </script>
</body>
</html>
